angular.module("youtube-embed",[]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,r){var t={},a=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,i=/t=(\d+)[ms]?(\d+)?s?/;function n(e,r){return-1<e.indexOf(r)}function o(){r.$apply(function(){t.ready=!0})}return t.getIdFromURL=function(e){var r,t=e.replace(a,"$1");return n(t,";")?t=n((r=t.split(";"))[1],"%")?("http://youtube.com"+decodeURIComponent(r[1])).replace(a,"$1"):r[0]:n(t,"#")&&(t=t.split("#")[0]),t},t.getTimeFromURL=function(e){var r=(e=e||"").match(i);if(!r)return 0;var t=r[0],a=r[1],o=r[2];return void 0!==o?(o=parseInt(o,10),a=parseInt(a,10)):n(t,"m")?(a=parseInt(a,10),o=0):(o=parseInt(a,10),a=0),o+60*a},t.ready=!1,"undefined"==typeof YT?(e.onYouTubeIframeAPIReady=o,console.log("Unable to find YouTube iframe library on this page.")):YT.loaded?t.ready=!0:YT.ready(o),t}]).directive("youtubeVideo",["$window","youtubeEmbedUtils",function(e,y){var p=1,c={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},s="youtube.player.";return e.YTConfig={host:"https://www.youtube-nocookie.com"},{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(t,e,r){t.utils=y;var a=r.playerId||e[0].id||"unique-youtube-embed-id-"+p++;function o(){var e=Array.prototype.slice.call(arguments);t.$apply(function(){t.$emit.apply(t,e)})}function i(e){var r=c[e.data];void 0!==r&&o(s+r,t.player,e),t.$apply(function(){t.player.currentState=r})}function n(e){o(s+"ready",t.player,e)}function l(e){o(s+"error",t.player,e)}function d(){(t.videoId||t.playerVars.list)&&(t.player&&"function"==typeof t.player.destroy&&t.player.destroy(),t.player=function(){var e=angular.copy(t.playerVars);e.start=e.start||t.urlStartTime;var r=new YT.Player(a,{height:t.playerHeight,width:t.playerWidth,videoId:t.videoId,playerVars:e,events:{onReady:n,onStateChange:i,onError:l}});return r.id=a,r}())}e[0].id=a,t.playerHeight=t.playerHeight||390,t.playerWidth=t.playerWidth||640,t.playerVars=t.playerVars||{};var u=t.$watch(function(){return t.utils.ready&&(void 0!==t.videoUrl||void 0!==t.videoId||void 0!==t.playerVars.list)},function(e){e&&(u(),void 0!==t.videoUrl?t.$watch("videoUrl",function(e){t.videoId=t.utils.getIdFromURL(e),t.urlStartTime=t.utils.getTimeFromURL(e),d()}):void 0!==t.videoId?t.$watch("videoId",function(){t.urlStartTime=null,d()}):t.$watch("playerVars.list",function(){t.urlStartTime=null,d()}))});t.$watchCollection(["playerHeight","playerWidth"],function(){t.player&&t.player.setSize(t.playerWidth,t.playerHeight)}),t.$on("$destroy",function(){t.player&&t.player.destroy()})}}}]);